\documentclass{article}
\usepackage[a4paper,hmargin=1.25in,vmargin=1in]{geometry}

\usepackage{listings} \usepackage[usenames,dvipsnames]{color}
\usepackage{amsmath}
\usepackage{latexsym}
\usepackage{mathtools}

\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

\definecolor{DarkGreen}{rgb}{0.0,0.4,0.0}
\definecolor{highlight}{RGB}{255,251,204}

\lstdefinestyle{Style1}{
language=PYTHON, 
backgroundcolor=\color{highlight}, 
basicstyle=\footnotesize\ttfamily,
breakatwhitespace=false,
breaklines=true,
captionpos=b,
commentstyle=\usefont{T1}{pcr}{m}{sl}\color{DarkGreen},
deletekeywords={},
%escapeinside={\%}, % This allows you to escape to LaTeX using the character in the bracket
firstnumber=1,
frame=single,
frameround=tttt,
keywordstyle=\color{Blue}\bf,
morekeywords={},
numbers=left,
numbersep=10pt,
numberstyle=\tiny\color{Gray},
rulecolor=\color{black},
showstringspaces=false,
showtabs=false,
stepnumber=1,
stringstyle=\color{Purple},
tabsize=2,
}

\newcommand{\insertcode}[2]{\begin{itemize}\item[]\lstinputlisting[caption=#2,label=#1,style=Style1]{#1}\end{itemize}}
%\newcommand\floor[1]{\lfloor#1\rfloor}
%\newcommand\ceil[1]{\lceil#1\rceil}

\begin{document}

\setcounter{section}{2}
\section{Integer Functions}
\subsection{FLOORS AND CEILINGS}
Define: $\ceil{x}$ is the least integer greater than or equal to $x$, and $\floor{x}$ is the greatest integer less than or equal to $x$.
Basic rules:
\begin{align}
\floor{x} &\le x; \\
\ceil{x} &\ge x.
\end{align}
The two functions are equal precisely at the integer points:
\begin{align}
\floor{x} = x \iff x \text{ is an integer} \iff \ceil{x} = x.
\end{align}
The two functions are inequal if not at the integer points:
\begin{align}
\ceil{x} - \floor{x} &= [x \text{ is not an integer}].
\end{align}
The two functinos can be converted:
\begin{align}
\ceil{-x} &= -\floor{x}; \\
\floor{-x} &= -\ceil{x}.
\end{align}
Integers can be easily removed or added in the two functions:
\begin{align}
\floor{x + n} &= \floor{x} + n; && \{\text{integer n}\} \\
\ceil{x + n} &= \ceil{x} + n. && \{\text{integer n}\}
\end{align}
For important rules:
\begin{align}
\floor{x} = n &\iff n \le x < n+1;\\
\floor{x} = n &\iff x-1 < n \le x;\\
\ceil{x} = n &\iff n-1 < x \le n;\\
\ceil{x} = n &\iff x \le n < x + 1.
\end{align}
There are many situations in which floor and ceiling brackets are redundant:
\begin{align}
x < n &\iff \floor{x} < n;\\
n < x &\iff n < \ceil{x};\\
x \le n &\iff \ceil{x} \le n;\\
n \le x &\iff n \le \floor{x}.
\end{align}
Define: $\{x\} = x - \floor{x}$ is the fractional part of $x$, then $\floor{x}$ is the integer part of $x$.
A simple notation is $x = n + \theta$.
\begin{align}
\floor{x + y} = \floor{x} + \floor{y} + \floor{\{x\} + \{y\}}.
\end{align}
\subsection{FLOOR/CEILING APPLICATIONS}
Problem 1: what is the bit number to express n in binary?
\begin{align}
&2^{m-1} \le x < 2^m \iff \text{the bit number is }m; \\
&m-1 \le \lg{x} < m \\
&m = \floor{\lg{x}} + 1. && \{x > 0\}
\end{align}
To support $x=0$, another better solution is $\ceil{\lg(x+1)}$.\\
Problem 2: what is $m = \floor{\sqrt{\floor{x}}}$ when $x \ge 0$?
\begin{align}
&m \le \sqrt{\floor{x}} < m + 1; \\
&m^2 \le \floor{x} < (m+1)^2; \\
&m^2 \le x < (m+1)^2; \\
&m \le \sqrt{x} < m + 1; \\
&m = \floor{\sqrt{x}}.
\end{align}
Problem 3: what is $m = \ceil{\sqrt{\ceil{x}}}$ when $x \ge 0$?
\begin{align}
&m - 1 < \sqrt{\ceil{x}} \le m; \\
&(m-1)^2 < \ceil{x} \le m^2; \\
&(m-1)^2 < x \le m^2; \\
&m-1 < \sqrt{x} \le m; \\
&m = \ceil{\sqrt{x}}.
\end{align}
A general theorem: let $f(x)$ be any continuous, monotonically increasing function with the property that
\begin{align}
f(x) = \text{integer} \implies x = \text{integer}.
\end{align}
Then there is:
\begin{align}
\floor{f(x)} = \floor{f(\floor{x})};\\
\ceil{f(x)} = \ceil{f(\ceil{x})}.
\end{align}
A special case of the theorem:
\begin{align}
\floor*{\frac{x+m}{n}} = \floor*{\frac{\floor{x}+m}{n}};\\
\ceil*{\frac{x+m}{n}} = \ceil*{\frac{\ceil{x}+m}{n}}.
\end{align}
Problem levels: 
\textbf{level 1} prove a given statement for a number;
\textbf{level 2} prove a given statement for a set of numbers;
\textbf{level 3} prove or disprove a given statement for a set of numbers;
\textbf{level 4} find a necessary and suffcient condition that a statement is true;
\textbf{level 5} find an interesting property given a set of numbers.\\
Consider the integer inside a range:
\begin{align}
\alpha \le n < \beta \iff \ceil{\alpha} \le n < \ceil{\beta};\\
\alpha < n \le \beta \iff \floor{\alpha} < n \le \floor{\beta}.
\end{align}
Then
\begin{align}
&[\alpha, \beta) \text{ contains } \ceil{\beta} - \ceil{\alpha}   \text{ elements}; && \{\alpha \le \beta\} \\
&(\alpha, \beta] \text{ contains } \floor{\beta} - \floor{\alpha} \text{ elements}; && \{\alpha \le \beta\} \\
&(\alpha, \beta) \text{ contains } \ceil{\beta} - \floor{\alpha}-1 \text{ elements}; && \{\alpha < \beta\} \\
&[\alpha, \beta] \text{ contains } \floor{\beta} - \ceil{\alpha}+1 \text{ elements}. && \{\alpha \le \beta\} 
\end{align}
Example 1:
\begin{align}
W &= \sum_{1\le n \le 1000} [\floor{\sqrt[3]{n}} \setminus n] \\
  &= \sum_{k,n} [k = \floor{\sqrt[3]{n}}] [1 \le n \le 1000] [k \setminus n] \\
  &= \sum_{k,n,m} [k^3 \le n < (k+1)^3] [n = km] [1 \le n \le 1000] \\
  &= 1 + \sum_{k,m} [k^3 \le km < (k+1)^3] [1 \le k < 10]\\
  &= 1 + \sum_{k,m} [k^2 \le m < (k+1)^3/k] [1 \le k < 10]\\
  &= 1 + \sum_{1\le k < 10} (\ceil{(k+1)^3/k} - \ceil{k^2})\\
  &= 1 + \sum_{1\le k < 10} (3k+4) = 172.
\end{align}
General case:
\begin{align}
W &= \sum_{1\le n \le N} [\floor{\sqrt[3]{n}} \setminus n] \\
  &= \sum_{k,n} [k = \floor{\sqrt[3]{n}}] [1 \le n \le N] [k \setminus n] \\
  &= \sum_{k,n,m} [k^3 \le n < (k+1)^3] [n = km] [1 \le n \le N] \\
  &= \sum_{k,m} [k^3 \le km < (k+1)^3] [1 \le k < K] + \sum_{k,m} [K^3 \le Km \le N] \\
  &= \sum_{k,m} [k^2 \le m < (k+1)^3/k] [1 \le k < K] + \sum_{k,m} [K^2 \le m \le N/K] \\
  &= \sum_{1 \le k < K} (3k+4) + \sum_{m} [m \in [K^2, N/K]]\\
  &= (7+3K+1)(K-1)/2 + \floor{N/K} - \ceil{K^2} + 1\\
  &= \frac{1}{2}K^2 + \frac{5}{2}K -3 + \floor{N/K}. &&\{K=\floor{\sqrt[3]{N}}\}
\end{align}
Define $Spec(\alpha) = \{\floor{\alpha}, \floor{2\alpha},...\}$ then $Spec(\sqrt{2})$ and $Spec(\sqrt{2}+2)$ forms a partition of positive integers.
Define $N(\alpha,n)$ is the number of elements in $Spec(\alpha)$ that are $\le n$.
\begin{align}
N(\alpha,n) &= \sum_{k>0}[\floor{\alpha k} \le n] \\
	    &= \sum_{k>0}[\floor{\alpha k} < n + 1] \\
	    &= \sum_{k>0}[\alpha k < n + 1] \\
	    &= \sum_{k>0}[ 0 < k < (n + 1)/\alpha] \\
	    &= \ceil{(n+1)/\alpha} - 1.
\end{align}
Then $N(\sqrt{2}, n) + N(\sqrt{2}+2, n) = n$. 
And it is easy to prove that if $\alpha \neq \beta$ then $Spec(\alpha) \neq Spec(\beta)$.
\subsection{FLOOR/CEILING RECURRENCES}
Knuth numbers:
\begin{align}
K_0 &= 1; \\
K_{n+1} &= 1 + min(2K_{\floor{n/2}}, 3K_{\floor{n/3}}).
\end{align}
The Josephus problem:
\begin{align}
J(1) &= 1; \\
J(n) &=  2J(\floor{n/2}) - (-1)^n.
\end{align}
Consider the more authentic Josephus problem in which every third person is eliminated:
\begin{align}
J_3(n) = \ceil*{\frac{3}{2}J_3(\floor*{\frac{2}{3}n}) + a_n} \mod (n+1).
\end{align}
where $a_n = -2,1,-\frac{1}{2}$ when $n \mod 3 = 0,1,2$.\\
Another method: Whenever a person is passed over, we can assign a new number.
\begin{center}
\begin{tabular}{ c c c c c c c c c c }
 \hline \\
 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 \\ 
 11 & 12 & & 13 & 14 & & 15 & 16 & & 17 \\  
 18 & & & 19 & 20 & & & 21 & & 22 \\
   &   &   & 23 & 24 &  & & & & 25 \\
   &   &   &  26 & &  & & & & 27 \\
   &   &   &  28 & &  & & & &  \\
   &   &   &  29 & &  & & & &  \\
   &   &   &  30 & &  & & & &  \\
\hline
\end{tabular}
\end{center}
Any number $3k+1$ has a next value $10 + 3k + 1 - k$, and $3k + 2$ has a next value $10 + 3k + 2 - k$.
More general, there are $n$ people at first and some person has a current number $N$.
For this person his last number should be $3k+1$ or $3k+2$, and this current number is $N = n + 2k+1$ or $N = n+2k+2$.
This means 
\begin{align}
k = \floor*{\frac{N - n - 1}{2}}.
\end{align}
And his last number can be converted into
\begin{align}
3k + (N - n - 2k) = k + N - n = \floor*{\frac{N - n - 1}{2}} + N - n.
\end{align}
For the last one to be terminated, his number should be $3n$.
Use the method we can always find his last number until the number is smaller than n which is his initial number.

\insertcode{"c3/a0.py"}{Method 0}

Let $D = 3n + 1 - N$, then $D = 1$ when $N = 3n$ and $D > 2n + 1$ when $N < n$.
$D$ can also be updated as $N$:
\begin{align}
D &= 3n + 1 - N  \\
  &= 3n + 1 - (\floor*{\frac{(3n + 1 - D) - n - 1}{2}} + (3n + 1 -D) - n)  \\
  &= n + D - \floor*{\frac{2n - D}{2}}  \\
  &= D - \floor*{\frac{-D}{2}} \\
  &= D + \ceil*{\frac{D}{2}} \\
  &= \ceil*{\frac{3D}{2}}.
\end{align}

\insertcode{"c3/a1.py"}{Method 1}

More general:

\insertcode{"c3/a2.py"}{Method 2}

Write it into a recurrence:
\begin{align}
D_0^{(q)} &= 1; \\
D_n^{(q)} &= \ceil*{\frac{q}{q-1} D_{n-1}^{(q)}}.
\end{align}

\subsection{`MOD': THE BINARY OPERATION}
Define operator `mod':
\begin{align}
x \text{ mod } y = x - y \floor{x / y}. && \{y \neq 0\}
\end{align}
Based on the defination, there are some attributes:
\begin{align}
0 \le x \text{ mod } y < y; && \{ y > 0\} \\
0 \ge x \text{ mod } y > y. && \{ y < 0\}
\end{align}
To complete the defination, we can let $x \text{ mod } y = x$ when $y = 0$.\\
The `mod' operator can be used to show the fractional part of a number:
\begin{align}
x = \floor{x} + x \text{ mod } 1.
\end{align}
A similar `mumble' operator can be defined:
\begin{align}
x \text{ mumble } y = y \ceil{x / y} - x. && \{y \neq 0\}
\end{align}
The `mod' operator follows the distributive law:
\begin{align}
c(x \text{ mod } y) = (cx) \text{ mod } (cy).
\end{align}
Problem: how to partition n things into m groups as equally as possible?\\
There will be $n \text{ mod } m$ groups contains $\ceil{n/m}$ things and the rest contains $\floor{n/m}$ things.
It also can be converted into:
\begin{align}
n = \ceil*{\frac{n}{m}} + \ceil*{\frac{n-1}{m}} +  ... + \ceil*{\frac{n - m + 1}{m}}.
\end{align}
and if change n to $km + n \text{ mod } m$, the equation can be converted into:
\begin{align}
n = \floor*{\frac{n}{m}} + \floor*{\frac{n+1}{m}} +  ... + \floor*{\frac{n + m - 1}{m}}.
\end{align}
If $n = \floor{mx}$:
\begin{align}
\floor{mx} = \floor*{x} + \floor*{x + \frac{1}{m}} +  ... + \floor*{x + \frac{m - 1}{m}}.
\end{align}

\subsection{FLOOR/CEILING SUMS}
Example 1, let $a = \floor{\sqrt{n}}$:
\begin{align}
\sum_{0 \le k < n} \floor{\sqrt{k}} &= \sum_{k,m \ge 0} m[m = \floor{\sqrt{k}}][k < n] \\
				    &= \sum_{k,m \ge 0} m[k<n][m \le \sqrt{k} < m+1] \\
				    &= \sum_{k,m \ge 0} m[k<n][m^2 \le k < (m+1)^2 \\
				    &= \sum_{k,m \ge 0} m[m^2 \le k < (m+1)^2 \le n]  + \sum_{k,m \ge 0} m[m^2 \le k < n < (m+1)^2] \\
				    &= \sum_{m \ge 0} m ((m+1)^2 - m^2)[m+1 \le a] + \sum_{m \ge 0} m(a^2 \le k < n) \\
				    &= \sum_{m \ge 0} (2m^2 + m )[m+1 \le a] + a(n - a^2) \\
				    &= \sum_{m \ge 0}  (2m^{\underline{2}} + 3m^{\underline{1}}) [m < a] - a^3 + an \\
				    &= \sum\nolimits_0^a (2m^{\underline{2}} + 3m^{\underline{1}})\delta m - a^3 + an \\
				    &= \frac{2}{3}m^{\underline{3}} + \frac{3}{2}m^{\underline{2}} - a^3 + an \\
				    &= na - \frac{1}{3}a^3 - \frac{1}{2}a^2 - \frac{1}{6}a.
\end{align}
Anothe method is le $\floor{x} = \sum_j [1 \le j \le x]$:
\begin{align}
\sum_{0 \le k < n} \floor{\sqrt{k}} &= \sum_{j,k} [1 \le j \le \sqrt{k}][0 \le k \le a^2] \\
				    &= \sum_{1 \le j < a} \sum_k [j^2 \le k < a^2] \\
				    &= \sum_{1 \le j < a} (a^2 - j^2) \\
				    &= na - \frac{1}{3}a^3 - \frac{1}{2}a^2 - \frac{1}{6}a.
\end{align}
Equidistribution theorem:
\begin{align}
\lim_{x\to\infty} \frac{1}{n}\sum_{0 \le k < n} f(\{k\alpha\}) = \int_{0}^{1} f(x) dx.
\end{align}
for all irrational $\alpha$ and all functions f that are continuous almost everywhere.\\
Example 2, let $d = gcd(m,n)$:
\begin{align}
\sum_{0 \le k < m} \floor*{\frac{nk + x}{m}} &= d\floor*{\frac{x}{d}} + \frac{m-1}{2}n + \frac{d-m}{2} \\
					     &= d\floor*{\frac{x}{d}} + \frac{mn}{2} - \frac{n}{2} - \frac{m}{2} + \frac{d}{2} \\
					     &= \sum_{0 \le k < n} \floor*{\frac{mk + x}{n}}.
\end{align}

\subsection{Exercises}
\textbf{Warmups 3.1:}

\noindent\rule{\textwidth}{0.4pt}
\textbf{Warmups 3.2:}

\noindent\rule{\textwidth}{0.4pt}
\textbf{Warmups 3.3:}

\noindent\rule{\textwidth}{0.4pt}
\textbf{Warmups 3.4:}

\noindent\rule{\textwidth}{0.4pt}
\textbf{Warmups 3.5:}

\noindent\rule{\textwidth}{0.4pt}
\textbf{Warmups 3.6:}

\noindent\rule{\textwidth}{0.4pt}
\textbf{Warmups 3.7:}

\noindent\rule{\textwidth}{0.4pt}
\textbf{Warmups 3.8:}

\noindent\rule{\textwidth}{0.4pt}
\textbf{Warmups 3.9:}


\end{document}
